import e,{useState as t,useRef as n,useEffect as o}from"react";import i from"prop-types";import{FaAlignRight as r}from"react-icons/fa";import a from"socket.io-client";function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function l(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}l(".king-ui-btn{background:var(--theme-background);color:var(--theme-color);border:var(--theme-border-width) var(--theme-border-style) var(--theme-border-color);border-radius:var(--theme-border-radius);font-size:unset;font-family:unset;cursor:pointer;user-select:none;padding:.35em .5em .2em}.king-ui-btn:hover{background:var(--theme-special--hover)}.king-ui-btn:active{background:var(--theme-special--active)}.king-ui-btn:focus{outline:0}.king-ui-btn--disabled{color:var(--theme-color--disabled);border-color:var(--theme-border-color--disabled);cursor:default}.king-ui-btn--disabled,.king-ui-btn--disabled:active,.king-ui-btn--disabled:hover{background:var(--theme-background--disabled)}");const c=({style:t,className:n,shadow:o,disabled:i,children:r,...a})=>{const l=["king-ui-btn",i?"king-ui-btn--disabled":"",n||""];return e.createElement("button",s({style:{boxShadow:o?i?"var(--theme-box-shadow--disabled)":"var(--theme-box-shadow)":"none",...t},className:l.join(" "),disabled:i},a),r)};c.propTypes={style:i.object,className:i.array,shadow:i.bool,disabled:i.bool,children:i.oneOfType([i.arrayOf(i.object.node),i.node.isRequired])};l("");const d=()=>e.createElement(e.Fragment,null);d.propTypes={};l('.king-ui-input input[type=number]::-webkit-inner-spin-button,.king-ui-input input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.king-ui-input input:focus{outline:0}.king-ui-input input:focus+span,.king-ui-input input:not([value=""])+span{transform:translateY(-1.5em)}');const u=({style:t,className:n,fontSize:o,shadow:i,underline:r,disabled:a,children:l,...c})=>e.createElement("span",s({style:{fontSize:o||"none",fontFamily:"unset",color:a?"var(--theme-color--disabled)":"var(--theme-color)",textDecoration:r?"underline":"none",textShadow:i?a?"var(--theme-text-shadow--disabled)":"var(--theme-text-shadow)":"none",...t},className:n},c),l);u.propTypes={style:i.object,className:i.string,fontSize:i.string,shadow:i.bool,underline:i.bool,disabled:i.bool,children:i.oneOfType([i.arrayOf(i.object.node),i.node.isRequired])};const m=({style:t,className:n,type:o,value:i,text:r,fontSize:a,onChange:l,...c})=>e.createElement("div",{style:{display:"flex",position:"relative",flexDirection:"column",textAlign:"center",padding:"1.2em 0 .2em 0",fontSize:a,fontFamily:"unset",...t},className:`king-ui-input ${n}`},e.createElement("input",s({style:{width:"100%",textAlign:"center",fontSize:"1em",fontFamily:"unset",border:"none",borderBottom:"var(--theme-border-width) var(--theme-border-style) var(--theme-border-color)",borderRadius:"var(--theme-border-radius)",background:"var(--theme-input-background)",color:"var(--theme-input-color)"},type:o,value:i,onChange:l},c)),e.createElement(u,{style:{position:"absolute",pointerEvents:"none",width:"100%",top:"50%",transition:"transform .25s ease",fontSize:".9em"},shadow:!!i||(0===i||!1)},r));m.defaultProps={fontSize:"unset",type:"text"},m.propTypes={style:i.object,className:i.string,type:i.string,value:i.oneOfType([i.string,i.number]),text:i.string,fontSize:i.string,onChange:i.func};const f=()=>{let e=window.screen.availHeight;return e=window.screen.availWidth<e?window.screen.availWidth:window.screen.availHeight,e/1080>1?e/1080*16+"px":e/1080*16*(e/1080*2.5<=1?2.5:1)+"px"},p=({style:t,className:n,fontSize:o,children:i,...r})=>e.createElement("div",s({style:{position:"relative",userSelect:"none",background:"unset",color:"unset",fontSize:o||f(),fontFamily:"unset",...t},className:n},r),i);p.propTypes={style:i.object,className:i.string,fontSize:i.string,children:i.oneOfType([i.arrayOf(i.object.node),i.node.isRequired])};const b=["NavMenuBar","NavMenuOverlay","NavMenuRelative"],y=({style:i,className:r,zIndex:a,fontSize:s,shadow:l,position:d,offset:u,icon:m,toggleMenu:f,children:p})=>{const[y,g]=t(f),h=n(!0),v={tr:{top:u,right:u},tl:{top:u,left:u},br:{bottom:u,right:u},bl:{bottom:u,left:u}};if(p&&b.includes(p.displayName))throw new Error(`Invalid child for "Nav", expect one of '${b.join("', '")}'`);return o((()=>{h.current?h.current=!1:g((e=>!e))}),[f]),e.createElement(e.Fragment,null,y&&p,e.createElement(c,{style:{position:"fixed",zIndex:a,fontSize:s||"unset",fontFamily:"unset",...v[d]||v.tr,...i},className:r,shadow:l,onClick:()=>g((e=>!e))},m))};y.defaultProps={position:"tr",offset:".5em",zIndex:500,fontSize:"1em",icon:e.createElement(r,{style:{fontSize:"none"}}),toggleMenu:!1},y.propTypes={style:i.object,className:i.string,zIndex:i.number,fontSize:i.string,shadow:i.bool,position:i.oneOf(["tr","tl","bl","br"]),offset:i.string,icon:i.node.isRequired,toggleMenu:i.bool,children:i.node};const g=({style:t,className:n,zIndex:o,space:i,children:r})=>e.createElement("div",{style:{display:"flex",position:"fixed",zIndex:o,flexDirection:"column",justifyContent:"center",alignItems:"center",fontSize:"unset",fontFamily:"unset",background:"var(--theme-nav-background)",top:0,left:0,width:"100vw",height:"100vh",...t},className:n},r instanceof Array?r.map(((t,n)=>e.createElement("div",{key:n,style:{padding:i}},t))):r);g.defaultProps={zIndex:500,space:"1em"},g.propTypes={style:i.object,className:i.string,zIndex:i.number,space:i.string,children:i.oneOfType([i.arrayOf(i.node.isRequired),i.node.isRequired])};const h=({active:i,children:r})=>{const[a,s]=t(),l=n([]);return o((()=>{l.current=r instanceof Array?r:[r]}),[r]),o((()=>[s((()=>l.current.filter((e=>e.props.route===i))))]),[i]),e.createElement(e.Fragment,null,a)};h.propTypes={active:i.string.isRequired,children:i.oneOfType([i.arrayOf(i.node.isRequired),i.node.isRequired])};const v={},k=(e,t=!0)=>{v[e]&&(t?v[e].callbacks={}:(v[e].client.connected&&(console.log("disconnect from:",e),v[e].client.disconnect()),delete v[e]))},w=({endpoint:e,id:t,...n})=>(o((()=>{function o(t,...n){for(const o of Object.values(v[e].callbacks[t]))o(...n)}if(v[e])for(const i of Object.keys(n))v[e].callbacks[i]||(console.log("init event",i,e),v[e].client.on(i,((...e)=>o(i,...e))),v[e].callbacks[i]={}),v[e].callbacks[i][t]||(v[e].callbacks[i][t]=n[i]);else v[e]=function(){console.log({endpoint:e,handler:n});const i=a.connect(e),r={};for(const[a,s]of Object.entries(n))console.log("init event",a,e),i.on(a,((...e)=>o(a,...e))),r[a]={},r[a][t]=s;return{client:i,callbacks:r}}()}),[e,n]),null);w.defaultProps={id:0},w.defaultProps={endpoint:i.oneOfType([i.arrayOf(i.string),i.string]),id:i.oneOfType([i.number,i.string])};l(".king-ui-notify--error,.king-ui-notify--info,.king-ui-notify--warn{display:flex;flex-direction:column}");const x={},z={info:"king-ui-notify--info king-ui-card--info",warn:"king-ui-notify--warn king-ui-card--warn",error:"king-ui-notify--error king-ui-card--error"},N=({className:t,card:n,timeout:i,onClick:r,...a})=>(o((()=>{setTimeout((()=>{}),i)}),[i]),e.createElement("div",s({style:{display:"flex",flexDirection:"column"},className:t,onClick:r},a),n.title&&e.createElement(u,{style:{margin:".5em"},fontSize:"1.3em",shadow:!0,underline:!0},n.title),n.message&&e.createElement(u,{style:{margin:".5em"},fontSize:".9em"},n.message)));N.propTypes={className:i.string,card:i.object,timeout:i.number,onClick:i.func};const S=({title:t=null,message:n,level:o="info",id:i="king-ui-notify",...r}={})=>{const a=z[o];if(!a)throw new Error(`Unknown level "${o}"`);const l=x[i].cards.current.length,c={id:l,title:t,message:n};x[i].addCard(e.createElement(N,s({key:l,cardid:l,className:a,card:c,timeout:6e3,onClick:()=>x[i].removeCard(l)},r)))},E=({style:i,id:r,...a})=>{const s=t(!1)[1],l=n([]),c=n(null);return o((()=>(x[r]={container:c,addCard:e=>{l.current.unshift(e),s((e=>!e))},cards:l,removeCard:e=>{let t=-1;for(const n of l.current)if(t++,n.props.cardid===e)break;l.current.splice(t,1),s((e=>!e))}},()=>{delete x[r]})),[r]),e.createElement("div",{id:r,style:{display:l.current.length?"flex":"none",position:"absolute",flexDirection:"column",overflowY:"auto",zIndex:999,width:"100%",maxWidth:"30ch",...i},ref:c},l.current)};E.defaultProps={id:"king-ui-notify"},E.propTypes={style:i.object,id:i.string};export{c as Button,m as Input,w as IoHandler,y as Nav,g as NavMenuOverlay,E as NotifyContainer,p as Root,h as Router,u as Text,d as ToggleSwitch,k as clearIoStorage,S as notify};
