import e,{useEffect as t,useState as n,useRef as o,useCallback as i}from"react";import r from"prop-types";import s from"socket.io-client";import{FaAlignRight as a}from"react-icons/fa";function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function c(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}c(".king-ui-btn{cursor:pointer;user-select:none;background:var(--theme-background);color:var(--theme-color);font-size:unset;font-family:unset;padding:.35em .5em .2em;border:var(--theme-border-width) var(--theme-border-style) var(--theme-border-color);border-radius:var(--theme-border-radius)}.king-ui-btn:hover{background:var(--theme-special--hover)}.king-ui-btn:active{background:var(--theme-special--active)}.king-ui-btn:focus{outline:none}.king-ui-btn--disabled{cursor:default;color:var(--theme-color--disabled);border-color:var(--theme-border-color--disabled)}.king-ui-btn--disabled,.king-ui-btn--disabled:active,.king-ui-btn--disabled:hover{background:var(--theme-background--disabled)}");const d=({style:t,className:n,shadow:o,disabled:i,children:r,...s})=>{const a=["king-ui-btn",i?"king-ui-btn--disabled":"",n||""];return e.createElement("button",l({style:{boxShadow:o?i?"var(--theme-box-shadow--disabled)":"var(--theme-box-shadow)":"none",...t},className:a.join(" "),disabled:i},s),r)};d.propTypes={style:r.object,className:r.string,shadow:r.bool,disabled:r.bool,children:r.oneOfType([r.arrayOf(r.object.node),r.node.isRequired])};const u={_io:{},_events:{},clear:async function(){for(const e of Object.keys(this._io))this._io[e].disconnect(),this._io[e].close(),delete this._io[e]},connect:async function(e,t){if(!e){if("function"==typeof t)return t(new Error("Endpoint Missing"),null);throw new Error("Endpoint Missing!")}if(this._io[e]?this._io[e].connected?console.log(`Nothing to do for "${e}"`):(console.log(`"${e}" exists, try reconnect.`),this._io[e].connect(e)):(console.log(`Create endpoint to "${e}"`),this._io[e]=s(e),console.log({_io:this._io})),"function"==typeof t)return t(null,this._io[e])},disconnect:async function(e,t){},event:async function(e,t){},eventRemove:async function(e,t){}},m={},p=(e,t=!0)=>{m[e]&&(t?m[e].callbacks={}:(m[e].client.connected&&m[e].client.disconnect(),delete m[e]))},f=({endpoint:e,id:n,...o})=>(t((()=>{function t(t,...n){for(const o of Object.values(m[e].callbacks[t]))o(...n)}if(m[e])for(const i of Object.keys(o))m[e].callbacks[i]||(m[e].client.on(i,((...e)=>t(i,...e))),m[e].callbacks[i]={}),m[e].callbacks[i][n]||(m[e].callbacks[i][n]=o[i]);else m[e]=function(){const i=s.connect(e),r={};for(const[e,s]of Object.entries(o))i.on(e,((...n)=>t(e,...n))),r[e]={},r[e][n]=s;return{client:i,callbacks:r}}()}),[e,o]),null);f.defaultProps={id:0},f.defaultProps={endpoint:r.oneOfType([r.arrayOf(r.string),r.string]),id:r.oneOfType([r.number,r.string])};c('.king-ui-input{display:flex;position:relative;flex-direction:column;text-align:center;padding:1.2em 0 .2em;font-size:unset;font-family:unset}.king-ui-input input{text-align:center;font-size:1em;font-family:unset;background:var(--theme-input-background);color:var(--theme-input-color);width:100%;border:none;border-bottom:var(--theme-border-width) var(--theme-border-style) var(--theme-border-color);border-radius:var(--theme-border-radius)}.king-ui-input input[type=number]::-webkit-inner-spin-button,.king-ui-input input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.king-ui-input input:focus{outline:none}.king-ui-input span{position:absolute;top:50%;font-size:.9em;transition:transform .25s ease;width:100%;pointer-events:none}.king-ui-input input:focus+span,.king-ui-input input:not([value=""])+span{transform:translateY(-1.5em)}');const g=({style:t,className:n,fontSize:o,shadow:i,bold:r,bolder:s,italic:a,oblique:c,underline:d,disabled:u,children:m,...p})=>e.createElement("span",l({style:{fontSize:o||"none",fontFamily:"unset",color:u?"var(--theme-color--disabled)":"var(--theme-color)",fontStyle:a?"italic":c?"oblique":"none",fontWeight:r?"bold":s?"bolder":"none",textDecoration:d?"underline":"none",textShadow:i?u?"var(--theme-text-shadow--disabled)":"var(--theme-text-shadow)":"none",...t},className:n},p),m);g.propTypes={style:r.object,className:r.string,fontSize:r.string,shadow:r.bool,bold:r.bool,bolder:r.bool,italic:r.bool,oblique:r.bool,underline:r.bool,disabled:r.bool,children:r.oneOfType([r.arrayOf(r.object.node),r.node.isRequired])};const b=({style:t,className:n,type:o,value:i,text:r,fontSize:s,onChange:a,...c})=>e.createElement("div",{style:{fontSize:s,...t},className:`king-ui-input ${n||""}`},e.createElement("input",l({type:o,value:i,onChange:a},c)),e.createElement(g,{shadow:!!i||(0===i||!1)},r));b.defaultProps={fontSize:"unset",type:"text"},b.propTypes={style:r.object,className:r.string,type:r.string,value:r.oneOfType([r.string,r.number]),text:r.string,fontSize:r.string,onChange:r.func};c('.king-ui-toggleswitch{position:relative;display:inline-block;font-size:1em;width:3em;height:1.59375em}.king-ui-toggleswitch input{opacity:0;width:0;height:0}.king-ui-toggleswitch span{position:absolute;cursor:pointer;top:0;right:0;bottom:0;left:0;background:var(--theme-background-light);border-radius:2rem}.king-ui-toggleswitch span:before{position:absolute;left:.1875em;bottom:.15em;transition:all .25s ease;background:var(--theme-input-color);content:"";height:1.21875em;width:1.21875em;border-radius:50%}.king-ui-toggleswitch input:checked+span:before{transform:translateX(1.21875em)}.king-ui-toggleswitch input:checked+span{background:var(--theme-special--primary)}');const h=({className:t,isToggled:n,onChange:o,...i})=>e.createElement("label",l({className:`king-ui-toggleswitch ${t||""}`},i),e.createElement("input",{type:"checkbox",checked:n,onChange:o}),e.createElement("span",null));h.propTypes={className:r.string,isToggled:r.bool,onChange:r.func};c(".king-ui-nav-button{position:fixed;z-index:100;font-size:1em;font-family:unset}.king-ui-nav-button>*{font-size:none}");const y=({style:e,zIndex:t,shadow:n,children:o,...i})=>React.createElement(d,l({className:"king-ui-nav-button",style:{zIndex:t,...e},shadow:n},i),o);y.defaultProps={children:React.createElement(a,null),shadow:!1},y.propTypes={style:r.oneOfType([r.number,r.string]),zIndex:r.number,shadow:r.bool,children:r.node};c(".king-ui-nav-overlay{display:flex;position:fixed;z-index:100;top:0;left:0;font-size:1em;font-family:unset;flex-direction:column;justify-content:center;align-items:center;background:var(--theme-background);width:100vw;height:100vh}.king-ui-nav-overlay>*{margin:.75em}");const v=({style:e,zIndex:t,children:n,...o})=>React.createElement("div",l({className:"king-ui-nav-overlay",style:{zIndex:t,...e}},o),n);v.propTypes={style:r.oneOfType([r.number,r.string]),zIndex:r.number,children:r.oneOfType([r.arrayOf(r.node),r.node])};const k=({styleOverlay:e,style:r,zIndex:s,toggleMenu:a,posNavButton:c,childrenNavButton:d,children:u,propsOverlay:m,...p})=>{const[f,g]=n(a),b=o(!0),h=i((()=>({tr:{top:".5em",right:".5em"},tl:{top:".5em",left:".5em"},br:{bottom:".5em",right:".5em"},bl:{bottom:".5em",left:".5em"}}[c])),[c]);return t((()=>{b.current?b.current=!1:g((e=>!e))}),[a]),React.createElement(React.Fragment,null,f&&React.createElement(v,l({style:e,zIndex:s},m),u),React.createElement(y,l({style:{...r,...h},zIndex:s},p),d))};k.defaultProps={toggleMenu:!1,posNavButton:"tr"},k.propTypes={style:r.oneOfType([r.number,r.string]),styleOverlay:r.oneOfType([r.number,r.string]),zIndex:r.number,toggleMenu:r.bool,posNavButton:r.oneOf(["tr","tl","br","bl"]),childrenNavButton:r.oneOfType([r.arrayOf(r.node),r.node]),children:r.oneOfType([r.arrayOf(r.node),r.node]),propsOverlay:r.object};c(".king-ui-notify--error,.king-ui-notify--info,.king-ui-notify--warn{display:flex;flex-direction:column}");const w={},x={info:"king-ui-notify--info king-ui-card--info",warn:"king-ui-notify--warn king-ui-card--warn",error:"king-ui-notify--error king-ui-card--error"},O=({className:n,cardid:o,card:i,timeout:r,onClick:s,...a})=>(t((()=>{setTimeout((()=>{console.log(`@TODO timeout handler for "${o}" [timeout: ${r}]`)}),r)}),[r,o]),e.createElement("div",l({style:{display:"flex",flexDirection:"column"},className:n,onClick:s},a),i.title&&e.createElement(g,{style:{margin:".5em"},fontSize:"1.3em",shadow:!0,underline:!0},i.title),i.message&&e.createElement(g,{style:{margin:".5em"},fontSize:".9em"},i.message)));O.propTypes={className:r.string,card:r.object,cardid:r.oneOfType([r.string.isRequired,r.number.isRequired]),timeout:r.number,onClick:r.func};const z=({title:t=null,message:n,level:o="info",id:i="king-ui-notify",...r}={})=>{const s=x[o];if(!s)throw new Error(`Unknown level "${o}"`);const a=w[i].cards.current.length,c={id:a,title:t,message:n};w[i].addCard(e.createElement(O,l({key:a,cardid:a,className:s,card:c,timeout:6e3,onClick:()=>w[i].removeCard(a)},r)))},T=({style:i,id:r,...s})=>{const a=n(!1)[1],c=o([]),d=o(null);return t((()=>(w[r]={container:d,addCard:e=>{c.current.unshift(e),a((e=>!e))},cards:c,removeCard:e=>{let t=-1;for(const n of c.current)if(t++,n.props.cardid===e)break;c.current.splice(t,1),a((e=>!e))}},()=>{delete w[r]})),[r]),e.createElement("div",l({id:r,style:{display:c.current.length?"flex":"none",position:"absolute",flexDirection:"column",overflowY:"auto",zIndex:999,width:"100%",maxWidth:"30ch",...i},ref:d},s),c.current)};T.defaultProps={id:"king-ui-notify"},T.propTypes={style:r.object,id:r.string};c(".king-ui-root{position:relative;user-select:none;background:unset;color:unset;font-size:unset;font-family:unset}");const N=()=>{let e=window.screen.availHeight;return e=window.screen.availWidth<e?window.screen.availWidth:window.screen.availHeight,e/1080>1?e/1080*16+"px":e/1080*16*(e/1080*2.5<=1?2.5:1)+"px"},E=({style:t,className:n,fontSize:o,children:i,...r})=>e.createElement("div",l({style:{fontSize:o||N(),...t},className:`king-ui-root ${n||""}`},r),i);E.propTypes={style:r.object,className:r.string,fontSize:r.string,children:r.oneOfType([r.arrayOf(r.object.node),r.node.isRequired])};const C=({active:i,children:r})=>{const[s,a]=n(),l=o([]);return t((()=>{l.current=r instanceof Array?r:[r]}),[r]),t((()=>[a((()=>l.current.filter((e=>e.props.route===i))))]),[i]),e.createElement(e.Fragment,null,s)};C.propTypes={active:r.string.isRequired,children:r.oneOfType([r.arrayOf(r.node.isRequired),r.node.isRequired])};export{d as Button,b as Input,f as IoHandler,k as NavMenuOverlay,T as NotifyContainer,E as Root,C as Router,g as Text,h as ToggleSwitch,p as clearIoStorage,u as ioClient,z as notify};
