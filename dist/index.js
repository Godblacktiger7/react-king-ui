"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("prop-types"),n=require("react-icons/fa"),a=require("socket.io-client");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=o(e),l=o(t),i=o(a);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function d(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}d(".king-ui-btn{background:var(--theme-background);color:var(--theme-color);border:var(--theme-border-width) var(--theme-border-style) var(--theme-border-color);border-radius:var(--theme-border-radius);font-size:unset;font-family:unset;cursor:pointer;user-select:none;padding:.35em .5em .2em}.king-ui-btn:hover{background:var(--theme-special--hover)}.king-ui-btn:active{background:var(--theme-special--active)}.king-ui-btn:focus{outline:0}.king-ui-btn--disabled{color:var(--theme-color--disabled);border-color:var(--theme-border-color--disabled);cursor:default}.king-ui-btn--disabled,.king-ui-btn--disabled:active,.king-ui-btn--disabled:hover{background:var(--theme-background--disabled)}");const u=({style:e,className:t,shadow:n,disabled:a,children:o,...l})=>{const i=["king-ui-btn",a?"king-ui-btn--disabled":"",t||""];return r.default.createElement("button",s({style:{boxShadow:n?a?"var(--theme-box-shadow--disabled)":"var(--theme-box-shadow)":"none",...e},className:i.join(" "),disabled:a},l),o)};u.propTypes={style:l.default.object,className:l.default.array,shadow:l.default.bool,disabled:l.default.bool,children:l.default.oneOfType([l.default.arrayOf(l.default.object.node),l.default.node.isRequired])};d("");const c=()=>r.default.createElement(r.default.Fragment,null);c.propTypes={};d('.king-ui-input input[type=number]::-webkit-inner-spin-button,.king-ui-input input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.king-ui-input input:focus{outline:0}.king-ui-input input:focus+span,.king-ui-input input:not([value=""])+span{transform:translateY(-1.5em)}');const f=({style:e,className:t,fontSize:n,shadow:a,underline:o,disabled:l,children:i,...d})=>r.default.createElement("span",s({style:{fontSize:n||"none",fontFamily:"unset",color:l?"var(--theme-color--disabled)":"var(--theme-color)",textDecoration:o?"underline":"none",textShadow:a?l?"var(--theme-text-shadow--disabled)":"var(--theme-text-shadow)":"none",...e},className:t},d),i);f.propTypes={style:l.default.object,className:l.default.string,fontSize:l.default.string,shadow:l.default.bool,underline:l.default.bool,disabled:l.default.bool,children:l.default.oneOfType([l.default.arrayOf(l.default.object.node),l.default.node.isRequired])};const p=({style:e,className:t,type:n,value:a,text:o,fontSize:l,onChange:i,...d})=>r.default.createElement("div",{style:{display:"flex",position:"relative",flexDirection:"column",textAlign:"center",padding:"1.2em 0 .2em 0",fontSize:l,fontFamily:"unset",...e},className:`king-ui-input ${t}`},r.default.createElement("input",s({style:{width:"100%",textAlign:"center",fontSize:"1em",fontFamily:"unset",border:"none",borderBottom:"var(--theme-border-width) var(--theme-border-style) var(--theme-border-color)",borderRadius:"var(--theme-border-radius)",background:"var(--theme-input-background)",color:"var(--theme-input-color)"},type:n,value:a,onChange:i},d)),r.default.createElement(f,{style:{position:"absolute",pointerEvents:"none",width:"100%",top:"50%",transition:"transform .25s ease",fontSize:".9em"},shadow:!!a||(0===a||!1)},o));p.defaultProps={fontSize:"unset",type:"text"},p.propTypes={style:l.default.object,className:l.default.string,type:l.default.string,value:l.default.oneOfType([l.default.string,l.default.number]),text:l.default.string,fontSize:l.default.string,onChange:l.default.func};const m=()=>{let e=window.screen.availHeight;return e=window.screen.availWidth<e?window.screen.availWidth:window.screen.availHeight,e/1080>1?e/1080*16+"px":e/1080*16*(e/1080*2.5<=1?2.5:1)+"px"},b=({style:e,className:t,fontSize:n,children:a,...o})=>r.default.createElement("div",s({style:{position:"relative",userSelect:"none",background:"unset",color:"unset",fontSize:n||m(),fontFamily:"unset",...e},className:t},o),a);b.propTypes={style:l.default.object,className:l.default.string,fontSize:l.default.string,children:l.default.oneOfType([l.default.arrayOf(l.default.object.node),l.default.node.isRequired])};const y=["NavMenuBar","NavMenuOverlay","NavMenuRelative"],g=({style:t,className:n,zIndex:a,fontSize:o,shadow:l,position:i,offset:s,icon:d,toggleMenu:c,children:f})=>{const[p,m]=e.useState(c),b=e.useRef(!0),g={tr:{top:s,right:s},tl:{top:s,left:s},br:{bottom:s,right:s},bl:{bottom:s,left:s}};if(f&&y.includes(f.displayName))throw new Error(`Invalid child for "Nav", expect one of '${y.join("', '")}'`);return e.useEffect((()=>{b.current?b.current=!1:m((e=>!e))}),[c]),r.default.createElement(r.default.Fragment,null,p&&f,r.default.createElement(u,{style:{position:"fixed",zIndex:a,fontSize:o||"unset",fontFamily:"unset",...g[i]||g.tr,...t},className:n,shadow:l,onClick:()=>m((e=>!e))},d))};g.defaultProps={position:"tr",offset:".5em",zIndex:500,fontSize:"1em",icon:r.default.createElement(n.FaAlignRight,{style:{fontSize:"none"}}),toggleMenu:!1},g.propTypes={style:l.default.object,className:l.default.string,zIndex:l.default.number,fontSize:l.default.string,shadow:l.default.bool,position:l.default.oneOf(["tr","tl","bl","br"]),offset:l.default.string,icon:l.default.node.isRequired,toggleMenu:l.default.bool,children:l.default.node};const h=({style:e,className:t,zIndex:n,space:a,children:o})=>r.default.createElement("div",{style:{display:"flex",position:"fixed",zIndex:n,flexDirection:"column",justifyContent:"center",alignItems:"center",fontSize:"unset",fontFamily:"unset",background:"var(--theme-nav-background)",top:0,left:0,width:"100vw",height:"100vh",...e},className:t},o instanceof Array?o.map(((e,t)=>r.default.createElement("div",{key:t,style:{padding:a}},e))):o);h.defaultProps={zIndex:500,space:"1em"},h.propTypes={style:l.default.object,className:l.default.string,zIndex:l.default.number,space:l.default.string,children:l.default.oneOfType([l.default.arrayOf(l.default.node.isRequired),l.default.node.isRequired])};const v=({active:t,children:n})=>{const[a,o]=e.useState(),l=e.useRef([]);return e.useEffect((()=>{l.current=n instanceof Array?n:[n]}),[n]),e.useEffect((()=>[o((()=>l.current.filter((e=>e.props.route===t))))]),[t]),r.default.createElement(r.default.Fragment,null,a)};v.propTypes={active:l.default.string.isRequired,children:l.default.oneOfType([l.default.arrayOf(l.default.node.isRequired),l.default.node.isRequired])};const k={},x=({endpoint:t,id:n,...a})=>(e.useEffect((()=>{function e(e,...n){for(const a of Object.values(k[t].callbacks[e]))a(...n)}if(k[t])for(const o of Object.keys(a))k[t].callbacks[o]||(console.log("init event",o,t),k[t].client.on(o,((...t)=>e(o,...t))),k[t].callbacks[o]={}),k[t].callbacks[o][n]||(k[t].callbacks[o][n]=a[o]);else k[t]=function(){console.log({endpoint:t,handler:a});const o=i.default.connect(t),r={};for(const[l,i]of Object.entries(a))console.log("init event",l,t),o.on(l,((...t)=>e(l,...t))),r[l]={},r[l][n]=i;return{client:o,callbacks:r}}()}),[t,a]),null);x.defaultProps={id:0},x.defaultProps={endpoint:l.default.oneOfType([l.default.arrayOf(l.default.string),l.default.string]),id:l.default.oneOfType([l.default.number,l.default.string])};d(".king-ui-notify--error,.king-ui-notify--info,.king-ui-notify--warn{display:flex;flex-direction:column}");const w={},N={info:"king-ui-notify--info king-ui-card--info",warn:"king-ui-notify--warn king-ui-card--warn",error:"king-ui-notify--error king-ui-card--error"},z=({className:t,card:n,timeout:a,onClick:o,...l})=>(e.useEffect((()=>{setTimeout((()=>{}),a)}),[a]),r.default.createElement("div",s({style:{display:"flex",flexDirection:"column"},className:t,onClick:o},l),n.title&&r.default.createElement(f,{style:{margin:".5em"},fontSize:"1.3em",shadow:!0,underline:!0},n.title),n.message&&r.default.createElement(f,{style:{margin:".5em"},fontSize:".9em"},n.message)));z.propTypes={className:l.default.string,card:l.default.object,timeout:l.default.number,onClick:l.default.func};const S=({style:t,id:n,...a})=>{const o=e.useState(!1)[1],l=e.useRef([]),i=e.useRef(null);return e.useEffect((()=>(w[n]={container:i,addCard:e=>{l.current.unshift(e),o((e=>!e))},cards:l,removeCard:e=>{let t=-1;for(const n of l.current)if(t++,n.props.cardid===e)break;l.current.splice(t,1),o((e=>!e))}},()=>{delete w[n]})),[n]),r.default.createElement("div",{id:n,style:{display:l.current.length?"flex":"none",position:"absolute",flexDirection:"column",overflowY:"auto",zIndex:999,width:"100%",maxWidth:"30ch",...t},ref:i},l.current)};S.defaultProps={id:"king-ui-notify"},S.propTypes={style:l.default.object,id:l.default.string},exports.Button=u,exports.Input=p,exports.IoHandler=x,exports.Nav=g,exports.NavMenuOverlay=h,exports.NotifyContainer=S,exports.Root=b,exports.Router=v,exports.Text=f,exports.ToggleSwitch=c,exports.clearIoStorage=(e,t=!0)=>{k[e]&&(t?k[e].callbacks={}:(k[e].client.connected&&(console.log("disconnect from:",e),k[e].client.disconnect()),delete k[e]))},exports.notify=({title:e=null,message:t,level:n="info",id:a="king-ui-notify",...o}={})=>{const l=N[n];if(!l)throw new Error(`Unknown level "${n}"`);const i=w[a].cards.current.length,d={id:i,title:e,message:t};w[a].addCard(r.default.createElement(z,s({key:i,cardid:i,className:l,card:d,timeout:6e3,onClick:()=>w[a].removeCard(i)},o)))};
