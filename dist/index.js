"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("prop-types"),n=require("react-icons/fa"),o=require("socket.io-client");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=a(e),r=a(t),l=a(o);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function d(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}d(".king-ui-btn{cursor:pointer;user-select:none;background:var(--theme-background);color:var(--theme-color);font-size:unset;font-family:unset;padding:.35em .5em .2em;border:var(--theme-border-width) var(--theme-border-style) var(--theme-border-color);border-radius:var(--theme-border-radius)}.king-ui-btn:hover{background:var(--theme-special--hover)}.king-ui-btn:active{background:var(--theme-special--active)}.king-ui-btn:focus{outline:none}.king-ui-btn--disabled{cursor:default;color:var(--theme-color--disabled);border-color:var(--theme-border-color--disabled)}.king-ui-btn--disabled,.king-ui-btn--disabled:active,.king-ui-btn--disabled:hover{background:var(--theme-background--disabled)}");const u=({style:e,className:t,shadow:n,disabled:o,children:a,...r})=>{const l=["king-ui-btn",o?"king-ui-btn--disabled":"",t||""];return i.default.createElement("button",s({style:{boxShadow:n?o?"var(--theme-box-shadow--disabled)":"var(--theme-box-shadow)":"none",...e},className:l.join(" "),disabled:o},r),a)};u.propTypes={style:r.default.object,className:r.default.string,shadow:r.default.bool,disabled:r.default.bool,children:r.default.oneOfType([r.default.arrayOf(r.default.object.node),r.default.node.isRequired])};d('.king-ui-toggleswitch{position:relative;display:inline-block;font-size:1em;width:3em;height:1.59375em}.king-ui-toggleswitch input{opacity:0;width:0;height:0}.king-ui-toggleswitch span{position:absolute;cursor:pointer;top:0;right:0;bottom:0;left:0;background:var(--theme-background-light);border-radius:2rem}.king-ui-toggleswitch span:before{position:absolute;left:.1875em;bottom:.15em;transition:all .25s ease;background:var(--theme-input-color);content:"";height:1.21875em;width:1.21875em;border-radius:50%}.king-ui-toggleswitch input:checked+span:before{transform:translateX(1.21875em)}.king-ui-toggleswitch input:checked+span{background:var(--theme-special--primary)}');const c=({className:e,isToggled:t,onChange:n,...o})=>i.default.createElement("label",s({className:`king-ui-toggleswitch ${e||""}`},o),i.default.createElement("input",{type:"checkbox",checked:t,onChange:n}),i.default.createElement("span",null));c.propTypes={className:r.default.string,isToggled:r.default.bool,onChange:r.default.func};d('.king-ui-input{display:flex;position:relative;flex-direction:column;text-align:center;padding:1.2em 0 .2em;font-size:unset;font-family:unset}.king-ui-input input{text-align:center;font-size:1em;font-family:unset;background:var(--theme-input-background);color:var(--theme-input-color);width:100%;border:none;border-bottom:var(--theme-border-width) var(--theme-border-style) var(--theme-border-color);border-radius:var(--theme-border-radius)}.king-ui-input input[type=number]::-webkit-inner-spin-button,.king-ui-input input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.king-ui-input input:focus{outline:none}.king-ui-input span{position:absolute;top:50%;font-size:.9em;transition:transform .25s ease;width:100%;pointer-events:none}.king-ui-input input:focus+span,.king-ui-input input:not([value=""])+span{transform:translateY(-1.5em)}');const f=({style:e,className:t,fontSize:n,shadow:o,bold:a,bolder:r,italic:l,oblique:d,underline:u,disabled:c,children:f,...p})=>i.default.createElement("span",s({style:{fontSize:n||"none",fontFamily:"unset",color:c?"var(--theme-color--disabled)":"var(--theme-color)",fontStyle:l?"italic":d?"oblique":"none",fontWeight:a?"bold":r?"bolder":"none",textDecoration:u?"underline":"none",textShadow:o?c?"var(--theme-text-shadow--disabled)":"var(--theme-text-shadow)":"none",...e},className:t},p),f);f.propTypes={style:r.default.object,className:r.default.string,fontSize:r.default.string,shadow:r.default.bool,bold:r.default.bool,bolder:r.default.bool,italic:r.default.bool,oblique:r.default.bool,underline:r.default.bool,disabled:r.default.bool,children:r.default.oneOfType([r.default.arrayOf(r.default.object.node),r.default.node.isRequired])};const p=({style:e,className:t,type:n,value:o,text:a,fontSize:r,onChange:l,...d})=>i.default.createElement("div",{style:{fontSize:r,...e},className:`king-ui-input ${t||""}`},i.default.createElement("input",s({type:n,value:o,onChange:l},d)),i.default.createElement(f,{shadow:!!o||(0===o||!1)},a));p.defaultProps={fontSize:"unset",type:"text"},p.propTypes={style:r.default.object,className:r.default.string,type:r.default.string,value:r.default.oneOfType([r.default.string,r.default.number]),text:r.default.string,fontSize:r.default.string,onChange:r.default.func};d(".king-ui-root{position:relative;user-select:none;background:unset;color:unset;font-size:unset;font-family:unset}");const m=()=>{let e=window.screen.availHeight;return e=window.screen.availWidth<e?window.screen.availWidth:window.screen.availHeight,e/1080>1?e/1080*16+"px":e/1080*16*(e/1080*2.5<=1?2.5:1)+"px"},g=({style:e,className:t,fontSize:n,children:o,...a})=>i.default.createElement("div",s({style:{fontSize:n||m(),...e},className:`king-ui-root ${t||""}`},a),o);g.propTypes={style:r.default.object,className:r.default.string,fontSize:r.default.string,children:r.default.oneOfType([r.default.arrayOf(r.default.object.node),r.default.node.isRequired])};const b=["NavMenuBar","NavMenuOverlay","NavMenuRelative"],h=({style:t,className:n,zIndex:o,fontSize:a,shadow:r,position:l,offset:s,icon:d,toggleMenu:c,children:f})=>{const[p,m]=e.useState(c),g=e.useRef(!0),h={tr:{top:s,right:s},tl:{top:s,left:s},br:{bottom:s,right:s},bl:{bottom:s,left:s}};if(f&&b.includes(f.displayName))throw new Error(`Invalid child for "Nav", expect one of '${b.join("', '")}'`);return e.useEffect((()=>{g.current?g.current=!1:m((e=>!e))}),[c]),i.default.createElement(i.default.Fragment,null,p&&f,i.default.createElement(u,{style:{position:"fixed",zIndex:o,fontSize:a||"unset",fontFamily:"unset",...h[l]||h.tr,...t},className:n,shadow:r,onClick:()=>m((e=>!e))},d))};h.defaultProps={position:"tr",offset:".5em",zIndex:500,fontSize:"1em",icon:i.default.createElement(n.FaAlignRight,{style:{fontSize:"none"}}),toggleMenu:!1},h.propTypes={style:r.default.object,className:r.default.string,zIndex:r.default.number,fontSize:r.default.string,shadow:r.default.bool,position:r.default.oneOf(["tr","tl","bl","br"]),offset:r.default.string,icon:r.default.node.isRequired,toggleMenu:r.default.bool,children:r.default.node};const y=({style:e,className:t,zIndex:n,space:o,children:a})=>i.default.createElement("div",{style:{display:"flex",position:"fixed",zIndex:n,flexDirection:"column",justifyContent:"center",alignItems:"center",fontSize:"unset",fontFamily:"unset",background:"var(--theme-nav-background)",top:0,left:0,width:"100vw",height:"100vh",...e},className:t},a instanceof Array?a.map(((e,t)=>i.default.createElement("div",{key:t,style:{padding:o}},e))):a);y.defaultProps={zIndex:500,space:"1em"},y.propTypes={style:r.default.object,className:r.default.string,zIndex:r.default.number,space:r.default.string,children:r.default.oneOfType([r.default.arrayOf(r.default.node.isRequired),r.default.node.isRequired])};const v=({active:t,children:n})=>{const[o,a]=e.useState(),r=e.useRef([]);return e.useEffect((()=>{r.current=n instanceof Array?n:[n]}),[n]),e.useEffect((()=>[a((()=>r.current.filter((e=>e.props.route===t))))]),[t]),i.default.createElement(i.default.Fragment,null,o)};v.propTypes={active:r.default.string.isRequired,children:r.default.oneOfType([r.default.arrayOf(r.default.node.isRequired),r.default.node.isRequired])};const k={},w=({endpoint:t,id:n,...o})=>(e.useEffect((()=>{function e(e,...n){for(const o of Object.values(k[t].callbacks[e]))o(...n)}if(k[t])for(const a of Object.keys(o))k[t].callbacks[a]||(k[t].client.on(a,((...t)=>e(a,...t))),k[t].callbacks[a]={}),k[t].callbacks[a][n]||(k[t].callbacks[a][n]=o[a]);else k[t]=function(){const a=l.default.connect(t),i={};for(const[t,r]of Object.entries(o))a.on(t,((...n)=>e(t,...n))),i[t]={},i[t][n]=r;return{client:a,callbacks:i}}()}),[t,o]),null);w.defaultProps={id:0},w.defaultProps={endpoint:r.default.oneOfType([r.default.arrayOf(r.default.string),r.default.string]),id:r.default.oneOfType([r.default.number,r.default.string])};d(".king-ui-notify--error,.king-ui-notify--info,.king-ui-notify--warn{display:flex;flex-direction:column}");const x={},N={info:"king-ui-notify--info king-ui-card--info",warn:"king-ui-notify--warn king-ui-card--warn",error:"king-ui-notify--error king-ui-card--error"},z=({className:t,cardid:n,card:o,timeout:a,onClick:r,...l})=>(e.useEffect((()=>{setTimeout((()=>{console.log(`@TODO timeout handler for "${n}" [timeout: ${a}]`)}),a)}),[a,n]),i.default.createElement("div",s({style:{display:"flex",flexDirection:"column"},className:t,onClick:r},l),o.title&&i.default.createElement(f,{style:{margin:".5em"},fontSize:"1.3em",shadow:!0,underline:!0},o.title),o.message&&i.default.createElement(f,{style:{margin:".5em"},fontSize:".9em"},o.message)));z.propTypes={className:r.default.string,card:r.default.object,cardid:r.default.oneOfType([r.default.string.isRequired,r.default.number.isRequired]),timeout:r.default.number,onClick:r.default.func};const E=({style:t,id:n,...o})=>{const a=e.useState(!1)[1],r=e.useRef([]),l=e.useRef(null);return e.useEffect((()=>(x[n]={container:l,addCard:e=>{r.current.unshift(e),a((e=>!e))},cards:r,removeCard:e=>{let t=-1;for(const n of r.current)if(t++,n.props.cardid===e)break;r.current.splice(t,1),a((e=>!e))}},()=>{delete x[n]})),[n]),i.default.createElement("div",s({id:n,style:{display:r.current.length?"flex":"none",position:"absolute",flexDirection:"column",overflowY:"auto",zIndex:999,width:"100%",maxWidth:"30ch",...t},ref:l},o),r.current)};E.defaultProps={id:"king-ui-notify"},E.propTypes={style:r.default.object,id:r.default.string},exports.Button=u,exports.Input=p,exports.IoHandler=w,exports.Nav=h,exports.NavMenuOverlay=y,exports.NotifyContainer=E,exports.Root=g,exports.Router=v,exports.Text=f,exports.ToggleSwitch=c,exports.clearIoStorage=(e,t=!0)=>{k[e]&&(t?k[e].callbacks={}:(k[e].client.connected&&k[e].client.disconnect(),delete k[e]))},exports.notify=({title:e=null,message:t,level:n="info",id:o="king-ui-notify",...a}={})=>{const r=N[n];if(!r)throw new Error(`Unknown level "${n}"`);const l=x[o].cards.current.length,d={id:l,title:e,message:t};x[o].addCard(i.default.createElement(z,s({key:l,cardid:l,className:r,card:d,timeout:6e3,onClick:()=>x[o].removeCard(l)},a)))};
